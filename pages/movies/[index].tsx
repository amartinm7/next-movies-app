import type { NextPage } from "next";
import Head from "next/head";
import styles from "./[index].module.scss";
import { Container, Link, Spacer, Text } from "@nextui-org/react";
import NextLink from "next/link";
import Theme from "@/components/themes/themes";
import { EchCardMovie } from "@/components/movies";
import { getMovieDetails } from "@/pages/api/movies/[id]";
import EchGrid from "@/components/grid";
import EchCardCredits from "@/components/credits/index";

// @ts-ignore
const MovieDetails: NextPage = ({ data }) => {
  return (
    <div className={styles.container}>
      <Head>
        <title>Estrenos Cine Hoy: Movie Details</title>
        <meta
          name="description"
          content="Generated by create next app and using NextUI as a react UI library"
        />
        <link rel="icon" href="/favicon.ico" />
      </Head>
      <Container as="main" display="inline">
        <Spacer />
        <Theme />
        <Text h1 className={styles.title}>
          Estrenos Cine Hoy
        </Text>
        <Spacer />
      </Container>
      <NextLink href={`/`}>
        <Link color="secondary">home</Link>
      </NextLink>
      <Container
        as="section"
        display="flex"
        wrap={"wrap"}
        justify={"space-between"}
        direction={"row"}
      >
        <EchGrid>
          <EchCardMovie {...data}></EchCardMovie>
        </EchGrid>
        <section>
          <EchCardCredits cast={data.credits.cast} />
        </section>
      </Container>
    </div>
  );
};

// @ts-ignore
export const getServerSideProps = async ({ params, query }) => {
  // @ts-ignore
  // https://www.learnbestcoding.com/post/25/nextjs-how-to-use-getServerSideProps
  const movieDetails = await getMovieDetails({
    id: query.index,
    language: query.language,
  });
  return {
    props: {
      data: movieDetails,
    },
  };
};

export default MovieDetails;
